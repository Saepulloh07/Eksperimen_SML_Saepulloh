apiVersion: 1

groups:
  - orgId: 1
    name: Heart Disease Model Alerts
    folder: Alerts
    interval: 1m
    rules:
      - uid: model_health_alert
        title: Model Health Check Failed
        condition: A
        data:
          - refId: A
            relativeTimeRange:
              from: 300
              to: 0
            datasourceUid: PBFA97CFB590B2093
            model:
              expr: heart_disease_model_health == 0
              intervalMs: 1000
              maxDataPoints: 43200
        noDataState: NoData
        execErrState: Alerting
        for: 2m
        annotations:
          description: Heart disease model health check is failing. The model may be down or experiencing issues.
          summary: Model {{ $labels.model }} is unhealthy
        labels:
          severity: critical
          team: ml-ops

      - uid: high_error_rate_alert
        title: High Model Error Rate
        condition: A
        data:
          - refId: A
            relativeTimeRange:
              from: 300
              to: 0
            datasourceUid: PBFA97CFB590B2093
            model:
              expr: rate(heart_disease_errors_total[5m]) > 0.1
              intervalMs: 1000
              maxDataPoints: 43200
        noDataState: NoData
        execErrState: Alerting
        for: 3m
        annotations:
          description: Model error rate is above threshold
          summary: High error rate detected for model {{ $labels.model }}
        labels:
          severity: warning
          team: ml-ops

      - uid: high_latency_alert
        title: High Prediction Latency
        condition: A
        data:
          - refId: A
            relativeTimeRange:
              from: 300
              to: 0
            datasourceUid: PBFA97CFB590B2093
            model:
              expr: histogram_quantile(0.95, rate(heart_disease_prediction_latency_seconds_bucket[5m])) > 1.0
              intervalMs: 1000
              maxDataPoints: 43200
        noDataState: NoData
        execErrState: Alerting
        for: 5m
        annotations:
          description: 95th percentile prediction latency exceeds 1 second threshold
          summary: High latency detected for model {{ $labels.model }}
        labels:
          severity: warning
          team: ml-ops
